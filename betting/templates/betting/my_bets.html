{% extends 'base.html' %}
{% load static %}

{% block title %}Minhas Apostas - Confian√ßa BET{% endblock %}

{% block content %}
<div class="min-h-screen bg-gradient-to-br from-gray-900 via-purple-900 to-gray-900">
    <!-- Header -->
    <div class="bg-gradient-to-r from-purple-600 to-pink-600 shadow-lg">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
            <div class="flex flex-col sm:flex-row justify-between items-center gap-4">
                <div class="flex items-center space-x-3">
                    <a href="{% url 'betting:home' %}" class="text-white hover:text-purple-200">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                        </svg>
                    </a>
                    <div>
                        <h1 class="text-2xl font-bold text-white">üé´ Minhas Apostas</h1>
                        <p class="text-purple-200 text-sm">Hist√≥rico completo de apostas</p>
                    </div>
                </div>
                <div class="bg-white/20 backdrop-blur-sm rounded-xl px-4 py-2 text-white">
                    <span class="text-xs text-purple-200">Seu saldo</span>
                    <div class="flex items-center space-x-1">
                        <span class="text-xl font-bold">{{ user_balance }}</span>
                        <span class="text-yellow-300">C$</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
        <!-- Statistics -->
        <div class="grid grid-cols-2 sm:grid-cols-5 gap-4 mb-8">
            <div class="bg-gray-800/50 backdrop-blur-sm rounded-xl p-4 border border-gray-700">
                <div class="text-gray-400 text-xs mb-1">Total</div>
                <div class="text-2xl font-bold text-white">{{ stats.total_bets|default:0 }}</div>
            </div>
            <div class="bg-yellow-900/50 backdrop-blur-sm rounded-xl p-4 border border-yellow-700">
                <div class="text-yellow-400 text-xs mb-1">Pendentes</div>
                <div class="text-2xl font-bold text-yellow-400">{{ stats.total_pending|default:0 }}</div>
            </div>
            <div class="bg-green-900/50 backdrop-blur-sm rounded-xl p-4 border border-green-700">
                <div class="text-green-400 text-xs mb-1">Vit√≥rias</div>
                <div class="text-2xl font-bold text-green-400">{{ stats.total_won|default:0 }}</div>
            </div>
            <div class="bg-red-900/50 backdrop-blur-sm rounded-xl p-4 border border-red-700">
                <div class="text-red-400 text-xs mb-1">Derrotas</div>
                <div class="text-2xl font-bold text-red-400">{{ stats.total_lost|default:0 }}</div>
            </div>
            <div class="bg-purple-900/50 backdrop-blur-sm rounded-xl p-4 border border-purple-700">
                <div class="text-purple-400 text-xs mb-1">Ganhos Totais</div>
                <div class="text-2xl font-bold text-purple-400">{{ stats.total_winnings|default:0 }} C$</div>
            </div>
        </div>

        <!-- Filters -->
        <div class="bg-gray-800/50 backdrop-blur-sm rounded-xl p-4 mb-6 border border-gray-700">
            <div class="flex flex-wrap gap-2">
                <a href="{% url 'betting:my_bets' %}" 
                   class="px-4 py-2 rounded-lg {% if not status_filter %}bg-purple-600 text-white{% else %}bg-gray-700 text-gray-300 hover:bg-gray-600{% endif %}">
                    Todas
                </a>
                <a href="{% url 'betting:my_bets' %}?status=pending" 
                   class="px-4 py-2 rounded-lg {% if status_filter == 'pending' %}bg-yellow-600 text-white{% else %}bg-gray-700 text-gray-300 hover:bg-gray-600{% endif %}">
                    ‚è≥ Pendentes
                </a>
                <a href="{% url 'betting:my_bets' %}?status=won" 
                   class="px-4 py-2 rounded-lg {% if status_filter == 'won' %}bg-green-600 text-white{% else %}bg-gray-700 text-gray-300 hover:bg-gray-600{% endif %}">
                    ‚úÖ Ganhas
                </a>
                <a href="{% url 'betting:my_bets' %}?status=lost" 
                   class="px-4 py-2 rounded-lg {% if status_filter == 'lost' %}bg-red-600 text-white{% else %}bg-gray-700 text-gray-300 hover:bg-gray-600{% endif %}">
                    ‚ùå Perdidas
                </a>
            </div>
        </div>

        <!-- Match Bets Section -->
        {% if match_bets %}
        <div class="mb-8">
            <h2 class="text-xl font-bold text-white mb-4 flex items-center space-x-2">
                <span>‚öΩ</span>
                <span>Apostas em Partidas</span>
                <span class="text-sm bg-purple-600/50 px-2 py-1 rounded-full">{{ match_bets|length }}</span>
            </h2>
            <div class="space-y-4">
                {% for bet in match_bets %}
                <div class="bg-gray-800/50 backdrop-blur-sm rounded-xl p-4 border border-gray-700 hover:border-purple-500/50 transition">
                    <div class="flex flex-col lg:flex-row justify-between gap-4">
                        <!-- Match Info -->
                        <div class="flex-1">
                            <div class="flex items-center space-x-2 mb-2">
                                <span class="text-xs text-purple-400">{{ bet.match.championship.name }}</span>
                                <span class="text-xs text-gray-500">‚Ä¢</span>
                                <span class="text-xs text-gray-500">{{ bet.created_at|date:"d/m/Y H:i" }}</span>
                            </div>
                            
                            <div class="flex items-center space-x-4">
                                <div class="text-center">
                                    <div class="text-white font-semibold">{{ bet.match.home_team.name }}</div>
                                    {% if bet.match.status == 'finished' %}
                                    <div class="text-2xl font-bold {% if bet.match.result == 'home' %}text-green-400{% else %}text-gray-400{% endif %}">
                                        {{ bet.match.home_score }}
                                    </div>
                                    {% endif %}
                                </div>
                                
                                <div class="text-gray-500">
                                    {% if bet.match.status == 'finished' %}
                                        <span class="text-2xl">-</span>
                                    {% else %}
                                        <span class="text-sm">VS</span>
                                    {% endif %}
                                </div>
                                
                                <div class="text-center">
                                    <div class="text-white font-semibold">{{ bet.match.away_team.name }}</div>
                                    {% if bet.match.status == 'finished' %}
                                    <div class="text-2xl font-bold {% if bet.match.result == 'away' %}text-green-400{% else %}text-gray-400{% endif %}">
                                        {{ bet.match.away_score }}
                                    </div>
                                    {% endif %}
                                </div>
                            </div>
                        </div>

                        <!-- Bet Details -->
                        <div class="flex flex-wrap items-center gap-4 lg:gap-6">
                            <div class="text-center">
                                <div class="text-xs text-gray-400 mb-1">Sua Aposta</div>
                                <div class="font-semibold 
                                    {% if bet.bet_type == 'home' %}text-green-400
                                    {% elif bet.bet_type == 'draw' %}text-yellow-400
                                    {% else %}text-blue-400{% endif %}">
                                    {% if bet.bet_type == 'home' %}
                                        üè† {{ bet.match.home_team.name }}
                                    {% elif bet.bet_type == 'draw' %}
                                        ü§ù Empate
                                    {% else %}
                                        ‚úàÔ∏è {{ bet.match.away_team.name }}
                                    {% endif %}
                                </div>
                            </div>
                            
                            <div class="text-center">
                                <div class="text-xs text-gray-400 mb-1">Valor</div>
                                <div class="text-white font-bold">{{ bet.amount }} C$</div>
                            </div>
                            
                            <div class="text-center">
                                <div class="text-xs text-gray-400 mb-1">Odd</div>
                                <div class="text-purple-400 font-bold">{{ bet.odds_at_bet }}</div>
                            </div>
                            
                            <div class="text-center">
                                <div class="text-xs text-gray-400 mb-1">Ganho Pot.</div>
                                <div class="text-yellow-400 font-bold">{{ bet.potential_win }} C$</div>
                            </div>
                            
                            <div class="text-center min-w-24">
                                {% if bet.status == 'pending' %}
                                    <span class="bg-yellow-600/30 text-yellow-400 px-4 py-2 rounded-full text-sm inline-block">
                                        ‚è≥ Pendente
                                    </span>
                                {% elif bet.status == 'won' %}
                                    <div>
                                        <span class="bg-green-600/30 text-green-400 px-4 py-2 rounded-full text-sm inline-block">
                                            üéâ Ganhou!
                                        </span>
                                        <div class="text-green-400 font-bold mt-1">+{{ bet.winnings }} C$</div>
                                    </div>
                                {% elif bet.status == 'lost' %}
                                    <span class="bg-red-600/30 text-red-400 px-4 py-2 rounded-full text-sm inline-block">
                                        üòî Perdeu
                                    </span>
                                {% elif bet.status == 'refunded' %}
                                    <span class="bg-gray-600/30 text-gray-400 px-4 py-2 rounded-full text-sm inline-block">
                                        üí∞ Reembolsado
                                    </span>
                                {% elif bet.status == 'cancelled' %}
                                    <span class="bg-gray-600/30 text-gray-400 px-4 py-2 rounded-full text-sm inline-block">
                                        üö´ Cancelado
                                    </span>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
        {% endif %}

        <!-- Champion Bets Section -->
        {% if champion_bets %}
        <div class="mb-8">
            <h2 class="text-xl font-bold text-white mb-4 flex items-center space-x-2">
                <span>üèÜ</span>
                <span>Apostas de Campe√£o</span>
                <span class="text-sm bg-yellow-600/50 px-2 py-1 rounded-full">{{ champion_bets|length }}</span>
            </h2>
            <div class="space-y-4">
                {% for bet in champion_bets %}
                <div class="bg-gray-800/50 backdrop-blur-sm rounded-xl p-4 border border-yellow-700/50 hover:border-yellow-500/50 transition">
                    <div class="flex flex-col lg:flex-row justify-between gap-4">
                        <div class="flex-1">
                            <div class="flex items-center space-x-2 mb-2">
                                <span class="text-xs text-yellow-400">üèÜ {{ bet.championship.name }}</span>
                                <span class="text-xs text-gray-500">‚Ä¢</span>
                                <span class="text-xs text-gray-500">{{ bet.created_at|date:"d/m/Y H:i" }}</span>
                            </div>
                            
                            <div class="text-lg font-bold text-white">
                                Campe√£o: {{ bet.sector.name }}
                            </div>
                            
                            {% if bet.championship.champion %}
                            <div class="text-sm text-gray-400 mt-1">
                                Campe√£o Real: <span class="text-yellow-400">{{ bet.championship.champion.name }}</span>
                            </div>
                            {% endif %}
                        </div>

                        <div class="flex flex-wrap items-center gap-4 lg:gap-6">
                            <div class="text-center">
                                <div class="text-xs text-gray-400 mb-1">Valor</div>
                                <div class="text-white font-bold">{{ bet.amount }} C$</div>
                            </div>
                            
                            <div class="text-center">
                                <div class="text-xs text-gray-400 mb-1">Odd</div>
                                <div class="text-yellow-400 font-bold">{{ bet.odds_at_bet }}x</div>
                            </div>
                            
                            <div class="text-center">
                                <div class="text-xs text-gray-400 mb-1">Ganho Pot.</div>
                                <div class="text-yellow-400 font-bold">{{ bet.potential_win }} C$</div>
                            </div>
                            
                            <div class="text-center min-w-24">
                                {% if bet.status == 'pending' %}
                                    <span class="bg-yellow-600/30 text-yellow-400 px-4 py-2 rounded-full text-sm inline-block">
                                        ‚è≥ Pendente
                                    </span>
                                {% elif bet.status == 'won' %}
                                    <div>
                                        <span class="bg-green-600/30 text-green-400 px-4 py-2 rounded-full text-sm inline-block">
                                            üéâ Ganhou!
                                        </span>
                                        <div class="text-green-400 font-bold mt-1">+{{ bet.winnings }} C$</div>
                                    </div>
                                {% elif bet.status == 'lost' %}
                                    <span class="bg-red-600/30 text-red-400 px-4 py-2 rounded-full text-sm inline-block">
                                        üòî Perdeu
                                    </span>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
        {% endif %}

        <!-- Scorer Bets Section -->
        {% if scorer_bets %}
        <div class="mb-8">
            <h2 class="text-xl font-bold text-white mb-4 flex items-center space-x-2">
                <span>‚öΩ</span>
                <span>Apostas de Artilheiro</span>
                <span class="text-sm bg-orange-600/50 px-2 py-1 rounded-full">{{ scorer_bets|length }}</span>
            </h2>
            <div class="space-y-4">
                {% for bet in scorer_bets %}
                <div class="bg-gray-800/50 backdrop-blur-sm rounded-xl p-4 border border-orange-700/50 hover:border-orange-500/50 transition">
                    <div class="flex flex-col lg:flex-row justify-between gap-4">
                        <div class="flex-1">
                            <div class="flex items-center space-x-2 mb-2">
                                <span class="text-xs text-orange-400">{{ bet.match.championship.name }}</span>
                                <span class="text-xs text-gray-500">‚Ä¢</span>
                                <span class="text-xs text-gray-500">{{ bet.created_at|date:"d/m/Y H:i" }}</span>
                            </div>
                            
                            <div class="text-sm text-gray-400 mb-1">
                                {{ bet.match.home_team.name }} x {{ bet.match.away_team.name }}
                            </div>
                            
                            <div class="text-lg font-bold text-white flex items-center space-x-2">
                                <span>‚öΩ</span>
                                <span>{{ bet.player.get_full_name }}</span>
                            </div>
                            <div class="text-xs text-gray-500">{{ bet.player.sector.name }}</div>
                        </div>

                        <div class="flex flex-wrap items-center gap-4 lg:gap-6">
                            <div class="text-center">
                                <div class="text-xs text-gray-400 mb-1">Valor</div>
                                <div class="text-white font-bold">{{ bet.amount }} C$</div>
                            </div>
                            
                            <div class="text-center">
                                <div class="text-xs text-gray-400 mb-1">Odd</div>
                                <div class="text-orange-400 font-bold">{{ bet.odds_at_bet }}x</div>
                            </div>
                            
                            <div class="text-center">
                                <div class="text-xs text-gray-400 mb-1">Ganho Pot.</div>
                                <div class="text-yellow-400 font-bold">{{ bet.potential_win }} C$</div>
                            </div>
                            
                            <div class="text-center min-w-24">
                                {% if bet.status == 'pending' %}
                                    <span class="bg-yellow-600/30 text-yellow-400 px-4 py-2 rounded-full text-sm inline-block">
                                        ‚è≥ Pendente
                                    </span>
                                {% elif bet.status == 'won' %}
                                    <div>
                                        <span class="bg-green-600/30 text-green-400 px-4 py-2 rounded-full text-sm inline-block">
                                            üéâ Ganhou!
                                        </span>
                                        <div class="text-green-400 font-bold mt-1">+{{ bet.winnings }} C$</div>
                                    </div>
                                {% elif bet.status == 'lost' %}
                                    <span class="bg-red-600/30 text-red-400 px-4 py-2 rounded-full text-sm inline-block">
                                        üòî Perdeu
                                    </span>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
        {% endif %}

        <!-- Empty State -->
        {% if not match_bets and not champion_bets and not scorer_bets %}
        <div class="bg-gray-800/50 rounded-xl p-12 text-center border border-gray-700">
            <div class="text-6xl mb-4">üé´</div>
            <h3 class="text-xl font-bold text-white mb-2">Nenhuma aposta encontrada</h3>
            <p class="text-gray-400 mb-6">
                {% if status_filter %}
                    Voc√™ n√£o tem apostas com este status.
                {% else %}
                    Voc√™ ainda n√£o fez nenhuma aposta.
                {% endif %}
            </p>
            <a href="{% url 'betting:home' %}" 
               class="inline-block bg-gradient-to-r from-purple-600 to-pink-600 text-white px-6 py-3 rounded-lg font-semibold hover:from-purple-500 hover:to-pink-500 transition">
                Ver Partidas Dispon√≠veis
            </a>
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}
