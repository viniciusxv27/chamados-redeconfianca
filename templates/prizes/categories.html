{% extends 'base.html' %}
{% load static %}

{% block title %}Gerenciar Categorias - Rede Confiança{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-8">
    <!-- Header -->
    <div class="flex items-center justify-between mb-8">
        <h1 class="text-3xl font-bold text-gray-900">
            <i class="fas fa-tags mr-3 text-blue-600"></i>
            Gerenciar Categorias de Prêmios
        </h1>
        <a href="{% url 'manage_prizes' %}" class="bg-gray-100 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-200 transition-colors">
            <i class="fas fa-arrow-left mr-2"></i>
            Voltar
        </a>
    </div>

    <!-- Formulário para nova categoria -->
    <div class="bg-white rounded-lg shadow-md p-6 mb-8">
        <h2 class="text-xl font-semibold mb-4">
            <i class="fas fa-plus mr-2 text-green-600"></i>
            Nova Categoria
        </h2>
        
        <form method="POST" class="space-y-4">
            {% csrf_token %}
            
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                <!-- Nome -->
                <div>
                    <label for="name" class="block text-sm font-medium text-gray-700 mb-2">
                        Nome *
                    </label>
                    <input type="text" id="name" name="name" required 
                           class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                           placeholder="Ex: Eletrônicos">
                </div>
                
                <!-- Ícone -->
                <div>
                    <label for="icon" class="block text-sm font-medium text-gray-700 mb-2">
                        Ícone (FontAwesome)
                    </label>
                    <div class="relative">
                        <input type="text" id="icon" name="icon" value="fas fa-gift"
                               class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent pl-10"
                               placeholder="fas fa-gift">
                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                            <i id="icon_preview" class="fas fa-gift text-gray-400"></i>
                        </div>
                    </div>
                </div>
                
                <!-- Cor -->
                <div>
                    <label for="color" class="block text-sm font-medium text-gray-700 mb-2">
                        Cor do Tema
                    </label>
                    <select id="color" name="color" 
                            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        <option value="blue">Azul</option>
                        <option value="green">Verde</option>
                        <option value="red">Vermelho</option>
                        <option value="yellow">Amarelo</option>
                        <option value="purple">Roxo</option>
                        <option value="pink">Rosa</option>
                        <option value="indigo">Índigo</option>
                        <option value="gray">Cinza</option>
                    </select>
                </div>
                
                <!-- Botão -->
                <div class="flex items-end">
                    <button type="submit" class="w-full bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors">
                        <i class="fas fa-plus mr-2"></i>
                        Criar
                    </button>
                </div>
            </div>
            
            <!-- Descrição -->
            <div>
                <label for="description" class="block text-sm font-medium text-gray-700 mb-2">
                    Descrição (opcional)
                </label>
                <input type="text" id="description" name="description" 
                       class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                       placeholder="Descrição da categoria...">
            </div>
        </form>
    </div>

    <!-- Lista de categorias -->
    <div class="bg-white rounded-lg shadow-md overflow-hidden">
        <div class="px-6 py-4 border-b border-gray-200">
            <h3 class="text-lg font-semibold">Categorias Existentes</h3>
        </div>
        
        {% if categories %}
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 p-6">
            {% for category in categories %}
            <div class="border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow">
                <div class="flex items-center justify-between mb-3">
                    <div class="flex items-center">
                        <div class="w-10 h-10 bg-{{ category.color }}-100 rounded-lg flex items-center justify-center mr-3">
                            <i class="{{ category.icon }} text-{{ category.color }}-600"></i>
                        </div>
                        <div>
                            <h4 class="font-semibold text-gray-900">{{ category.name }}</h4>
                            {% if category.description %}
                            <p class="text-sm text-gray-500">{{ category.description }}</p>
                            {% endif %}
                        </div>
                    </div>
                    
                    <div class="flex items-center gap-2">
                        {% if category.active %}
                            <span class="bg-green-100 text-green-800 px-2 py-1 rounded-full text-xs font-bold">
                                <i class="fas fa-check-circle"></i> Ativa
                            </span>
                        {% else %}
                            <span class="bg-red-100 text-red-800 px-2 py-1 rounded-full text-xs font-bold">
                                <i class="fas fa-times-circle"></i> Inativa
                            </span>
                        {% endif %}
                    </div>
                </div>
                
                <div class="flex items-center justify-between text-sm text-gray-500 mb-3">
                    <span>Prêmios: {{ category.prizes.count }}</span>
                    <span>Criada em {{ category.created_at|date:"d/m/Y" }}</span>
                </div>
                
                <div class="flex gap-2">
                    <button onclick="editCategory({{ category.id }})" class="flex-1 bg-blue-100 text-blue-700 px-3 py-2 rounded-lg hover:bg-blue-200 transition-colors text-sm">
                        <i class="fas fa-edit mr-1"></i>
                        Editar
                    </button>
                    <button onclick="toggleCategory({{ category.id }})" class="flex-1 bg-yellow-100 text-yellow-700 px-3 py-2 rounded-lg hover:bg-yellow-200 transition-colors text-sm">
                        {% if category.active %}
                            <i class="fas fa-pause mr-1"></i>
                            Desativar
                        {% else %}
                            <i class="fas fa-play mr-1"></i>
                            Ativar
                        {% endif %}
                    </button>
                    <button onclick="deleteCategory({{ category.id }})" class="bg-red-100 text-red-700 px-3 py-2 rounded-lg hover:bg-red-200 transition-colors text-sm">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
            </div>
            {% endfor %}
        </div>
        {% else %}
        <div class="p-12 text-center">
            <div class="text-gray-400 mb-4">
                <i class="fas fa-tags text-6xl"></i>
            </div>
            <h3 class="text-xl font-semibold text-gray-600 mb-2">Nenhuma categoria criada</h3>
            <p class="text-gray-500">Crie sua primeira categoria de prêmios acima.</p>
        </div>
        {% endif %}
    </div>

    <!-- Ícones sugeridos -->
    <div class="bg-white rounded-lg shadow-md p-6 mt-8">
        <h3 class="text-lg font-semibold mb-4">
            <i class="fas fa-lightbulb mr-2 text-yellow-500"></i>
            Ícones Sugeridos
        </h3>
        
        <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-8 gap-4">
            {% for icon in suggested_icons %}
            <div class="flex flex-col items-center p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer transition-colors" onclick="selectIcon('{{ icon.class }}')">
                <i class="{{ icon.class }} text-2xl text-gray-600 mb-2"></i>
                <span class="text-xs text-gray-500 text-center">{{ icon.name }}</span>
            </div>
            {% endfor %}
        </div>
    </div>
</div>

<script>
// Ícones sugeridos
const suggestedIcons = [
    {class: 'fas fa-gift', name: 'Presente'},
    {class: 'fas fa-laptop', name: 'Eletrônicos'},
    {class: 'fas fa-tshirt', name: 'Roupas'},
    {class: 'fas fa-utensils', name: 'Comida'},
    {class: 'fas fa-car', name: 'Transporte'},
    {class: 'fas fa-home', name: 'Casa'},
    {class: 'fas fa-gamepad', name: 'Games'},
    {class: 'fas fa-book', name: 'Educação'},
    {class: 'fas fa-dumbbell', name: 'Esportes'},
    {class: 'fas fa-music', name: 'Música'},
    {class: 'fas fa-camera', name: 'Foto'},
    {class: 'fas fa-heart', name: 'Saúde'},
    {class: 'fas fa-plane', name: 'Viagem'},
    {class: 'fas fa-spa', name: 'Beleza'},
    {class: 'fas fa-tools', name: 'Ferramentas'},
    {class: 'fas fa-palette', name: 'Arte'}
];

// Preview do ícone
document.getElementById('icon').addEventListener('input', function() {
    const iconPreview = document.getElementById('icon_preview');
    iconPreview.className = this.value || 'fas fa-gift text-gray-400';
});

// Selecionar ícone sugerido
function selectIcon(iconClass) {
    document.getElementById('icon').value = iconClass;
    document.getElementById('icon_preview').className = iconClass + ' text-gray-400';
}

// Funções de gerenciamento
function editCategory(categoryId) {
    alert('Funcionalidade de edição em desenvolvimento');
}

function toggleCategory(categoryId) {
    if (confirm('Deseja alterar o status desta categoria?')) {
        alert('Funcionalidade em desenvolvimento');
    }
}

function deleteCategory(categoryId) {
    if (confirm('Tem certeza que deseja excluir esta categoria? Esta ação não pode ser desfeita.')) {
        alert('Funcionalidade de exclusão em desenvolvimento');
    }
}

// Renderizar ícones sugeridos dinamicamente
document.addEventListener('DOMContentLoaded', function() {
    // Aqui você pode adicionar lógica para renderizar os ícones sugeridos se necessário
});
</script>

<style>
/* Cores dinâmicas para as categorias */
.bg-blue-100 { background-color: #dbeafe; }
.text-blue-600 { color: #2563eb; }
.text-blue-800 { color: #1e40af; }

.bg-green-100 { background-color: #dcfce7; }
.text-green-600 { color: #16a34a; }
.text-green-800 { color: #166534; }

.bg-red-100 { background-color: #fee2e2; }
.text-red-600 { color: #dc2626; }
.text-red-800 { color: #991b1b; }

.bg-yellow-100 { background-color: #fef3c7; }
.text-yellow-600 { color: #d97706; }
.text-yellow-800 { color: #92400e; }

.bg-purple-100 { background-color: #f3e8ff; }
.text-purple-600 { color: #9333ea; }
.text-purple-800 { color: #6b21a8; }

.bg-pink-100 { background-color: #fce7f3; }
.text-pink-600 { color: #db2777; }
.text-pink-800 { color: #9d174d; }

.bg-indigo-100 { background-color: #e0e7ff; }
.text-indigo-600 { color: #4f46e5; }
.text-indigo-800 { color: #3730a3; }

.bg-gray-100 { background-color: #f3f4f6; }
.text-gray-600 { color: #4b5563; }
.text-gray-800 { color: #1f2937; }
</style>
{% endblock %}
